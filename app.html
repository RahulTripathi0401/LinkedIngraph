<html>
<head>
    <title>LinkedIn graph Visualisation</title>
    <style type="text/css">
        #mynetwork {
        width: 100%;
        height:100%;
        border: 1px solid lightgray;
        }
    </style>
        <script type="text/javascript" src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script> 
    </head>
    <body>
    <p>
        Dynmaic LinkedIn graph Visualisation
    </p>
    <p>
        <input type="text" placeholder="Keyword search" id="search">
        <button id = "show">show graph</button>
        <div id="mynetwork"></div>
        <br /></p>

    <script type="text/javascript">
        const button = document.getElementById('show');
        const options = {
            manipulation: false,
            height: "90%",
            layout: {
                hierarchical: {
                enabled: true,
                levelSeparation: 300,
                },
            },
            physics: {
                hierarchicalRepulsion: {
                nodeDistance: 300,
                },
            },
        };
        button.addEventListener('click', async () => {
            let data = await fetch('http://localhost:3000/connections', {	
                method: 'GET'
            })
            .then( (response) => {
                if (response.ok) {
		            return response.json();
                }            
            }).catch( (err) => {
                // There was an error
                console.warn('Something went wrong.', err);
            });
            const edges = JSON.parse(data);

            data = await fetch('http://localhost:3000/nodes', {	
                method: 'GET'
            })
            .then( (response) => {
                if (response.ok) {
		            return response.json();
                }            
            }).catch( (err) => {
                // There was an error
                console.warn('Something went wrong.', err);
            });
            const nodes = JSON.parse(data);
            var container = document.getElementById('mynetwork');
            var info = {'nodes': nodes, 'edges': edges}
            var gph = new vis.Network(container, info, options);
        });
    </script>
    </body>
</html>